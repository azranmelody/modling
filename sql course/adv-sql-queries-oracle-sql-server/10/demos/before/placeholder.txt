/* Course Data */
/* Table: MYRXDATA */
/* Database: Oracle */
DROP TABLE MYRXDATA;
CREATE TABLE MYRXDATA(DATEKEY DATE,NDC_KEY VARCHAR2(11),COPAY_AMT NUMBER);
INSERT INTO MYRXDATA VALUES(DATE '2005-01-01','11111111111',5.12);
INSERT INTO MYRXDATA VALUES(DATE '2005-02-01','22222222222',10.24);

/* Table: DATEDIMENSION */
/* Database: Oracle */
DROP TABLE DATEDIMENSION;
CREATE TABLE DATEDIMENSION(DATEKEY DATE);
INSERT INTO DATEDIMENSION VALUES (DATE '2005-01-01');
INSERT INTO DATEDIMENSION VALUES (DATE '2005-02-01');
INSERT INTO DATEDIMENSION VALUES (DATE '2005-03-01');

/* Course Data */
/* Table: MYRXDATA */
/* Database: SQL Server */
DROP TABLE MYRXDATA;
CREATE TABLE MYRXDATA(DATEKEY SMALLDATETIME,NDC_KEY VARCHAR(11),COPAY_AMT FLOAT);
INSERT INTO MYRXDATA VALUES('2005-01-01','11111111111',5.12);
INSERT INTO MYRXDATA VALUES('2005-02-01','22222222222',10.24);

/* Table: DATEDIMENSION */
/* Database: SQL Server */
DROP TABLE DATEDIMENSION;
CREATE TABLE DATEDIMENSION(DATEKEY SMALLDATETIME);
INSERT INTO DATEDIMENSION VALUES ('2005-01-01');
INSERT INTO DATEDIMENSION VALUES ('2005-02-01');
INSERT INTO DATEDIMENSION VALUES ('2005-03-01');

/* CARTESIAN JOIN */
SELECT B.DATEKEY,A.NDC_KEY,A.COPAY_AMT
 FROM MYRXDATA A INNER JOIN DATEDIMENSION B

/* INNER JOIN */
SELECT B.DATEKEY,A.NDC_KEY,A.COPAY_AMT
 FROM MYRXDATA A INNER JOIN DATEDIMENSION B
 ON A.DATEKEY=B.DATEKEY

/* LEFT JOIN */
SELECT B.DATEKEY,A.NDC_KEY,A.COPAY_AMT
 FROM MYRXDATA A LEFT JOIN DATEDIMENSION B
 ON A.DATEKEY=B.DATEKEY

/* RIGHT JOIN */
SELECT B.DATEKEY,A.NDC_KEY,A.COPAY_AMT
 FROM MYRXDATA A RIGHT JOIN DATEDIMENSION B
 ON A.DATEKEY=B.DATEKEY

/* FULL JOIN */
SELECT B.DATEKEY,A.NDC_KEY,A.COPAY_AMT
 FROM MYRXDATA A FULL JOIN DATEDIMENSION B
 ON A.DATEKEY=B.DATEKEY

/* CARTESIAN PRODUCT/UNION ALL */
SELECT C.DATEKEY,C.NDC_KEY,SUM(C.COPAY_AMT) AS TOT
 FROM (
       SELECT DATEKEY,NDC_KEY,COPAY_AMT
        FROM MYRXDATA
       UNION ALL
       SELECT A.DATEKEY,B.NDC_KEY,NULL AS COPAY_AMT
        FROM (SELECT DISTINCT DATEKEY 
               FROM DATEDIMENSION) A,(SELECT DISTINCT NDC_KEY 
                                       FROM MYRXDATA) B
      ) C
 GROUP BY C.DATEKEY,C.NDC_KEY
 ORDER BY C.DATEKEY,C.NDC_KEY

/* PARTITION BY/RIGHT OUTER JOIN */
SELECT B.DATEKEY,A.NDC_KEY,A.COPAY_AMT
 FROM MYRXDATA A
  PARTITION BY (A.NDC_KEY)
  RIGHT OUTER JOIN DATEDIMENSION B
   ON A.DATEKEY=B.DATEKEY

Note: In SQL Server, when you run the code directly above, you get the error message:
 Msg 102, Level 15, State 1, Line 3
 Incorrect syntax near 'PARTITION'.


